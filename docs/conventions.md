# Соглашения по генерации кода (Code Conventions)

Этот документ содержит ключевые правила для AI-ассистента при генерации и модификации кода. Цель — поддержание высокого качества, консистентности и следование архитектурному видению проекта, описанному в `docs/vision.md`.

## Общие принципы

1.  **Следовать `vision.md`**: Всегда придерживаться архитектуры, технологий и принципов, изложенных в `docs/vision.md`.
2.  **Лаконичность и ясность**: Код должен быть чистым, хорошо структурированным и самодокументируемым. Избегать лишних комментариев.
3.  **Безопасность в приоритете**: Всегда помнить о безопасности, особенно при обработке пользовательского ввода и работе с секретами.
4.  **Производительность**: Предпочитать решения, которые обеспечивают высокую производительность, в соответствии с принципами Next.js App Router (Серверные компоненты, Server Actions).

## Строгие запреты (CRITICAL)

1.  **Никогда не изменять `.env`**: Файл `.env` предназначен только для локальной разработки пользователя. Не читать и не изменять его.
2.  **Генерировать код только по команде**: Приступать к генерации кода можно только после явного согласования предложенного решения и получения команды на реализацию.
3.  **Никаких бинарных файлов**: Не генерировать изображения, иконки (кроме SVG), архивы или любые другие нетекстовые файлы.

## Правила по кодированию

1.  **Архитектура**:
    -   Строго соблюдать трехслойную архитектуру (`UI Layer`, `Actions & Services Layer`, `Data Access Layer`), как описано в `vision.md`.
    -   UI-компоненты не должны напрямую обращаться к базе данных. Вся бизнес-логика должна быть в `Server Actions` и сервисах (`src/lib/services`).

2.  **Стилизация**:
    -   Использовать компоненты `ShadCN UI` (`/components/ui`) везде, где это возможно.
    -   Для стилизации использовать `Tailwind CSS` и переменные из `globals.css`. Не использовать жестко заданные цвета (например, `text-red-500`), вместо этого полагаться на семантические цвета темы (например, `text-destructive`).

3.  **Работа с данными**:
    -   Для локальной разработки (`!process.env.K_SERVICE`) сервисы должны возвращать моковые данные из `src/lib/mock-data.ts`.
    -   В продакшене — выполнять реальные запросы к БД. Эта условная логика должна присутствовать во всех сервисах.

4.  **Типы**:
    -   Всегда использовать TypeScript. Ключевые сущности (Product, Order, Category) должны соответствовать типам из `src/lib/types.ts`.

5.  **Иконки**:
    -   Использовать иконки из `lucide-react`. Перед использованием убедиться, что иконка действительно существует в библиотеке.

6.  **Логирование**:
    -   Активно использовать логгер.
        -   В клиентских компонентах: `import { logger } from '@/lib/logger';`
        -   В серверном коде: `import { serverLogger } from '@/lib/server-logger';`
    -   Создавать логгеры с осмысленными категориями: `logger.withCategory('CATEGORY_NAME')`.
