# 5. Архитектура "Комплексный монолит" и Ролевой доступ

Этот документ описывает принятую стратегию развития проекта как "Комплексного монолита" с разделением интерфейсов на основе ролей пользователей. Это решение является результатом анализа и соответствует текущей стадии развития бизнеса (см. `docs/product/02-roadmap.md`).

## 1. Основной принцип

Вместо создания нескольких отдельных приложений (для клиента, сборщика, курьера) мы развиваем **единое Next.js приложение**. Доступ к различным разделам и интерфейсам осуществляется на основе роли текущего пользователя.

**Пример структуры с использованием Route Groups в Next.js:**
```
src/app/
├── (customer)/      # Интерфейсы для клиентов (витрина, корзина, история заказов)
│   ├── page.tsx
│   └── catalog/
├── (staff)/         # Интерфейсы для персонала (сборщики, курьеры)
│   └── assembly/
└── (admin)/         # Административная панель (управление товарами, заказами)
    └── dashboard/
```

## 2. Ролевая модель (MVP)

На первом этапе мы реализуем следующие роли:

1.  **Гость (неаутентифицированный):**
    *   Доступ: Только к клиентским интерфейсам `(customer)`.
    *   Может: Просматривать каталог, добавлять товары в корзину.

2.  **Клиент (аутентифицированный):**
    *   Доступ: Только к клиентским интерфейсам `(customer)`.
    *   Может: Все, что и гость, плюс оформлять заказы, просматривать свою историю.

3.  **Администратор:**
    *   Доступ: Ко всем разделам, включая `(admin)`.
    *   Может: Управлять контентом, заказами, пользователями и настройками системы.

## 3. Техническая реализация

-   **Аутентификация:** Будет реализована позже (например, через Firebase Authentication или другой провайдер). На начальном этапе используется заглушка.
-   **Авторизация (проверка ролей):** Будет реализована с помощью Next.js Middleware (`middleware.ts`). Middleware будет проверять роль пользователя и разрешать или запрещать доступ к маршрутам, защищенным ролями (например, `/admin/*`).

Этот подход обеспечивает быстрый старт, низкие затраты на разработку и легкую поддержку, полностью соответствуя потребностям проекта на текущем этапе.
