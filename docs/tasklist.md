# üìã Tasklist ‚Äî Weighted Products

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–æ –∫—Ä—É–ø–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –±–ª–æ–∫–∞–º (—ç–ø–∏–∫–∞–º) —Å –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–µ–π –∏ —á–µ—Ç–∫–∏–º–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è–º–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.

---

## üìä –ü—Ä–æ–≥—Ä–µ—Å—Å –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

| –≠–ø–∏–∫ / –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª           | –°—Ç–∞—Ç—É—Å       | –ü—Ä–æ–≥—Ä–µ—Å—Å          | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | Blockers              | –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π | –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥                   |
| :-------------------------- | :----------- | :---------------- | :-------- | :-------------------- | :------------ | :------------------------------ |
| **MVP Foundation**          | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ  | ‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì (100%) | P1        | -                     | AI-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç  | -                               |
| **–ì–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–º** | ‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ | ‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí (50%)  | P1        | - | AI-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç  | Phase 2: Backend Services |

---

## üéØ –≠–ø–∏–∫: –ì–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏

**–¶–µ–ª—å:** —Å–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ—Å–æ–≤—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ—Å—á–µ—Ç–æ–º —Ü–µ–Ω –∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–µ–π –∑–∞–∫–∞–∑–æ–≤ –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏.

**Feature Flag:** `feature.weighted-products` (OFF –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

---

## üìë Dependencies

* Phase 3 (Admin UI) –∑–∞–≤–∏—Å–∏—Ç –æ—Ç Phase 2 (Backend)
* Phase 4 (User UI) —Ç—Ä–µ–±—É–µ—Ç Phase 1 + 2
* Phase 5 (Order Flow) –º–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å Phase 4

---

## ‚úÖ Definition of Ready (DoR)

–ü–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

* [ ] –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ
* [ ] API contracts –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
* [ ] Test strategy –ø–æ–Ω—è—Ç–Ω–∞
* [ ] Breaking changes –≤—ã—è–≤–ª–µ–Ω—ã

---

## üìã Phases (—Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏)

### Phase 1: Data Model & Migration (P1)
- [x] –¢–∏–ø—ã, –º–∏–≥—Ä–∞—Ü–∏–∏, –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **DoD:** `npm run build && npm run typecheck` –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ –æ—à–∏–±–æ–∫, –º–∏–≥—Ä–∞—Ü–∏—è + rollback –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

### Phase 2: Backend Services (P1)

* –í–∞–ª–∏–¥–∞—Ü–∏—è, conversion utils, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
* **DoD:** unit + integration —Ç–µ—Å—Ç—ã, –ø–æ–∫—Ä—ã—Ç–∏–µ ‚â•80%

### Phase 3: Admin Interface (P2)

* –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–æ—Ä–º, auto-fill rules
* **DoD:** E2E —Ç–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ—Å–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞

### Phase 4: User Interface (P2)

* Product card, –∫–æ—Ä–∑–∏–Ω–∞, step quantity logic
* **DoD:** UI —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, responsive + a11y –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

### Phase 5: Order Flow (P1 ‚Üí simplified)

* –ë–∞–∑–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å-—Ñ–ª–æ—É: `created ‚Üí assembled ‚Üí finalized`
* –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –ª–æ–≥–∏–∫–∞ –¥–æ–ø–ª–∞—Ç/–≤–æ–∑–≤—Ä–∞—Ç–æ–≤ = P2
* **DoD:** —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–∫–∞–∑–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º –≤–µ—Å–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç end-to-end

### Phase 6: Testing & QA (P1/P2)

* Unit, integration, E2E
* Performance + security audit
* **DoD:** CI –±–ª–æ–∫–∏—Ä—É–µ—Ç merge –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —Ç–µ—Å—Ç–æ–≤

### Phase 7: Documentation & Rollout (P2/P3)

* API docs, admin guide, migration guide
* Feature flag rollout + monitoring
* **DoD:** staged rollout, rollback –ø–ª–∞–Ω –ø—Ä–æ–≤–µ—Ä–µ–Ω

---

## üö® Risk Mitigation

| –†–∏—Å–∫                          | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è                                           |
| :---------------------------- | :---------- | :---------- | :-------------------------------------------------- |
| –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö        | –°—Ä–µ–¥–Ω—è—è     | –í—ã—Å–æ–∫–æ–µ     | Migration testing + staged rollout + feature flag   |
| UX confusion                  | –°—Ä–µ–¥–Ω—è—è     | –°—Ä–µ–¥–Ω–µ–µ     | Tooltips + beta-testing + onboarding guide          |
| Performance degradation       | –ù–∏–∑–∫–∞—è      | –°—Ä–µ–¥–Ω–µ–µ     | DB indexing + caching + load testing                |
| Rounding errors               | –ù–∏–∑–∫–∞—è      | –í—ã—Å–æ–∫–æ–µ     | –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ + unit tests edge cases |
| Payment adjustment complexity | –í—ã—Å–æ–∫–∞—è     | –°—Ä–µ–¥–Ω–µ–µ     | –ü–æ—à–∞–≥–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è, fallback —Å—Ü–µ–Ω–∞—Ä–∏–∏             |

---

## üöÄ Quick Wins

* [ ] –°–æ–∑–¥–∞—Ç—å feature flag `weighted-products`
* [ ] –î–æ–±–∞–≤–∏—Ç—å placeholder UI ("Coming soon")
* [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:

  ```
  docs/
  ‚îú‚îÄ‚îÄ tasklist.md
  ‚îú‚îÄ‚îÄ weighted-products/
  ‚îÇ   ‚îú‚îÄ‚îÄ technical-spec.md
  ‚îÇ   ‚îú‚îÄ‚îÄ api-contracts.md
  ‚îÇ   ‚îú‚îÄ‚îÄ testing-strategy.md
  ‚îÇ   ‚îî‚îÄ‚îÄ rollout-plan.md
  ```

---

## üìà Success Metrics

* **Technical:** 100% —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç, performance –≤ SLA
* **Business:** ‚â•X% —Ç–æ–≤–∞—Ä–æ–≤ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–æ –Ω–∞ –≤–µ—Å–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
* **User:** NPS –Ω–µ —Å–Ω–∏–∂–∞–µ—Ç—Å—è, complaint rate < 1%
* **Operational:** Onboarding admin < 30 –º–∏–Ω

---

## üîß Quick Reference

```bash
# Feature flag
npm run feature-flag enable weighted-products

# Tests
npm run test:weighted-products

# Migration
npm run migrate:up weighted-products
npm run migrate:down weighted-products
```

**Key files:**

* `src/lib/types.ts`
* `src/lib/services/products.service.ts`
* `src/lib/utils/weight-converter.ts`
* `components/admin/product-form.tsx`
* `components/cart/cart.tsx`
* `migrations/xxx-weighted-products.sql`

---

üìå *–î–æ–∫—É–º–µ–Ω—Ç –∂–∏–≤–æ–π, –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ –º–µ—Ä–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞. Blockers —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è —Å—Ä–∞–∑—É.*
