# План миграции данных и развития архитектуры: «Цифровой склад»

Этот документ описывает наш план по переходу от статического хранения данных о товарах к динамической системе на базе Firebase Firestore.

## 1. Где мы находимся сейчас? (Точка А)

Сейчас наш магазин похож на лавку, где весь ассортимент записан на одном большом листе бумаги.

*   **Источник данных:** Вся информация о товарах (цены, названия, описания) хранится в файле `src/lib/products.ts`.
*   **Ограничения:**
    *   **Негибкость:** Чтобы добавить новый товар или изменить цену, нужно редактировать код и перезапускать приложение.
    *   **Немасштабируемость:** Невозможно управлять большим ассортиментом, добавлять новые свойства товаров без усложнения кода.
    *   **Отсутствие админки:** Нет простого способа для менеджера управлять товарами.

Это было отличное решение для быстрого старта, но теперь оно тормозит наше развитие.

## 2. Куда мы хотим прийти? (Точка Б)

Наша цель — превратить "лавку" в современный супермаркет с централизованным "цифровым складом".

*   **Единый источник правды:** Вся бизнес-информация — и **заказы**, и **товары** — будет храниться в одном месте: нашей базе данных **Firebase Firestore**.
*   **Гибкость и масштабируемость:** Мы сможем легко добавлять, изменять и удалять товары без необходимости вмешиваться в код. Это закладывает фундамент для будущей панели администратора.
*   **Актуальность данных:** Клиенты всегда будут видеть самую свежую информацию о товарах.

Мы сознательно выбираем Firestore, а не SQL, чтобы использовать уже имеющуюся, настроенную инфраструктуру и сохранить архитектурную целостность проекта.

## 3. Как мы туда доберемся? (Наш маршрут)

Мы будем двигаться поэтапно, чтобы обеспечить плавный и безопасный переход.

### Шаг 1: «Инвентаризация и переезд на склад»
*   **Задача:** Перенести все товары с нашего "листка бумаги" (`products.ts`) на наш новый "цифровой склад" (в Firestore).
*   **Реализация:** Мы создадим специальный одноразовый скрипт (seeder), который автоматически прочитает все товары из файла и создаст для каждого из них отдельный документ в новой коллекции `products` в Firestore.

**Структура документа товара в Firestore:**
- `id` (string) - уникальный идентификатор
- `name` (string) - название товара  
- `price` (number) - цена в рублях
- `description` (string) - описание
- `category` (string) - категория
- `imageUrl` (string) - ссылка на изображение
- `createdAt` (timestamp) - дата создания
- `updatedAt` (timestamp) - дата последнего обновления

### Шаг 2: «Обучение персонала работе с новой системой»
*   **Задача:** "Научить" наше приложение брать данные не с "листка", а напрямую со "склада".
*   **Реализация:** Мы обновим код нашего каталога (`ProductCatalog`), страницы товара (`ProductPage`) и других компонентов. Вместо того чтобы импортировать массив из файла, они будут выполнять запросы к Firestore для получения списка товаров или одного товара по его ID.

### Шаг 3: «Выбрасываем старый блокнот»
*   **Задача:** Убрать старый, неактуальный источник данных.
*   **Реализация:** После того как мы убедимся, что приложение стабильно работает с данными из Firestore, мы полностью удалим файл `src/lib/products.ts`, чтобы он не вносил путаницу.

## 4. Риски и план их минимизации

- **Потеря данных при миграции** → Тестовая база позволяет смело экспериментировать и пересоздавать данные при необходимости
- **Проблемы с производительностью** → Использование существующей системы логирования для мониторинга времени отклика запросов к Firestore
- **Проблемы совместимости** → Постепенное обновление компонентов с сохранением интерфейсов

## 5. Критерии завершения миграции

- ✅ Все товары успешно перенесены в Firestore
- ✅ Приложение корректно отображает товары из базы
- ✅ Система логирования показывает стабильное время отклика
- ✅ Старый код удален, компоненты обновлены
- ✅ Возможность добавления новых товаров через админку (будущий функционал)

## 6. Мониторинг после миграции

**Используя существующую систему логирования:**
- Отслеживание времени отклика запросов к Firestore через логи
- Мониторинг ошибок загрузки товаров
- Анализ паттернов использования данных
- Контроль квот использования Firestore

**Ключевые метрики для отслеживания:**
- Среднее время загрузки каталога товаров
- Время отклика при получении отдельного товара
- Количество неуспешных запросов к базе

Этот план позволит нам создать надежную и масштабируемую основу для дальнейшего роста нашего онлайн-магазина.