# План развития системы каталогизации

Этот документ фиксирует архитектурные решения и план действий по улучшению управления товарами в админ-панели.

## 1. Управление Категориями (Группами товаров)

### Проблема
- Простое текстовое поле для ввода категории неудобно.
- Возможны опечатки и создание дубликатов (`Овощи`, `овощи`).
- Нет возможности централизованно управлять категориями (переименовывать, объединять).

### План действий

**Этап 1: Улучшение интерфейса (ближайший шаг)**
- **Задача:** Заменить текстовое поле "Категория" на продвинутый компонент **Combobox** (выпадающий список с поиском).
- **Реализация:**
    - Компонент будет подгружать список существующих категорий из базы данных.
    - Пользователь сможет как выбрать категорию из списка, так и ввести название новой. Если введено новое название, оно будет добавлено в базу при сохранении товара.

**Этап 2: Создание отдельной сущности "Категория"**
- **Задача:** Вынести категории в отдельную таблицу для полноценного управления.
- **Архитектурные изменения:**
    1.  Создать в базе данных новую таблицу `categories` со следующими полями:
        - `id` (UUID, первичный ключ)
        - `name` (TEXT, уникальное имя, например, "Овощи")
        - `slug` (TEXT, уникальное имя для URL, например, "vegetables")
        - `sku_prefix` (TEXT, префикс для артикула, например, "ОВ")
        - `description` (TEXT, опциональное описание)
    2.  В таблице `products` поле `category` (TEXT) заменить на `category_id` (UUID), который будет внешним ключом, ссылающимся на `categories.id`.
- **Изменения в интерфейсе:**
    1.  Создать новую страницу в админ-панели: `/admin/categories`.
    2.  На этой странице реализовать полный CRUD-интерфейс для категорий: создание, просмотр, редактирование (переименование, изменение префикса), удаление.

---

## 2. Множественные группы (Теги)

### Проблема
- Товар может принадлежать к нескольким логическим группам одновременно (например, "Овощи" и в то же время "Акция" или "Популярное").

### Решение: Разделение понятий

- **Категория:** Основная, иерархическая принадлежность товара. У товара может быть только **одна** категория. (Помидор - это "Овощи").
- **Теги:** Гибкие, маркетинговые метки. У товара может быть **множество** тегов. (Помидор может иметь теги `акция`, `популярное`, `фермерский`).

### План действий
- **Задача:** Улучшить интерфейс для управления тегами.
- **Реализация:**
    - Поле `tags` в таблице `products` уже существует (тип `TEXT[]`), что идеально подходит для этой задачи.
    - В форме создания/редактирования товара поле "Теги" превратить из простого текстового поля в компонент для ввода нескольких значений. Он может позволять как вводить новые теги, так и выбирать из списка уже существующих в системе.

---

## 3. Артикулы (SKU)

### Проблема
- Для внутреннего учета, интеграции со складскими системами и избежания путаницы товарам необходимы уникальные артикулы.

### Решение: Автоматическая генерация

- **Задача:** Внедрить систему автоматического создания уникального артикула при создании товара.
- **Формат артикула:** `[ПРЕФИКС_КАТЕГОРИИ]-[ПОРЯДКОВЫЙ_НОМЕР]` (например, `ОВ-016`).
- **Архитектурные изменения:**
    1.  Добавить в таблицу `categories` поле `sku_prefix` (см. пункт 1).
    2.  Добавить в таблицу `products` новое поле `sku` (TEXT, уникальное).
- **Логика реализации:**
    1.  При создании товара пользователь выбирает категорию.
    2.  В серверном экшене `createProductAction` перед сохранением товара:
        - Из таблицы `categories` по `category_id` извлекается `sku_prefix`.
        - Выполняется подсчет количества товаров в данной категории (`COUNT(*)`).
        - Генерируется новый порядковый номер (например, `count + 1`, с дополнением нулями до 3-4 знаков).
        - Формируется и сохраняется полный `sku` (например, `ОВ-016`).
    3.  Артикул отображается в карточке товара в админ-панели и является неизменяемым.
