# Settings to manage and configure a Firebase App Hosting backend.
# https://firebase.google.com/docs/app-hosting/configure

runConfig:
  # Increase this value if you'd like to automatically spin up
  # more instances in response to increased traffic.
  maxInstances: 1

# This specifies that this backend needs access to Cloud SQL
cloudsql:
  # The instance connection name can be found on the Cloud SQL instance overview page.
  instances:
    - fastbasket:europe-west10:delivery

# Use secret environment variables to securely pass credentials to the application
# The 'key' is the environment variable name available to the app.
# The 'secret' is the name of the secret in Google Secret Manager.
secretEnvironmentVariables:
  - key: PG_USER
    secret: PG_USER
  - key: PG_PASSWORD
    secret: PG_PASSWORD
  - key: PG_DATABASE
    secret: PG_DATABASE
  - key: S3_BUCKET_NAME
    secret: S3_BUCKET_NAME
  - key: S3_ENDPOINT_URL
    secret: S3_ENDPOINT_URL
  - key: S3_REGION
    secret: S3_REGION
  - key: S3_ACCESS_KEY_ID
    secret: S3_ACCESS_KEY_ID
  - key: S3_SECRET_ACCESS_KEY
    secret: S3_SECRET_ACCESS_KEY
  - key: NEXT_PUBLIC_S3_PUBLIC_URL
    secret: NEXT_PUBLIC_S3_PUBLIC_URL
  # PG_HOST and PG_PORT are NOT needed here, connection is handled via the socket path.
  # We still need to pass them for the local environment via .env file.
  # So we will provide them but with dummy values, they will not be used in the cloud.
  - key: PG_HOST
    secret: PG_HOST
    availability:
      - BUILD
  - key: PG_PORT
    secret: PG_PORT
    availability:
      - BUILD
